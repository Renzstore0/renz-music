<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Renz Music Player</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Roboto', sans-serif;
      background: #121212;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 20px;
      text-align: center;
    }
    #searchBox {
      width: 100%;
      max-width: 600px;
      padding: 12px 20px;
      border-radius: 50px;
      border: none;
      outline: none;
      font-size: 1rem;
      margin-bottom: 20px;
      background: #333;
      color: #fff;
    }
    #player {
      background: #1e1e1e;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      text-align: center;
      width: 100%;
      max-width: 600px;
      margin-bottom: 20px;
    }
    audio {
      width: 100%;
      margin-bottom: 15px;
      border-radius: 10px;
    }
    .controls {
      display: flex;
      justify-content: center;
      gap: 20px;
    }
    button {
      background: transparent;
      border: none;
      color: #fff;
      cursor: pointer;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: transform 0.3s ease, background 0.3s ease;
    }
    button:hover {
      transform: scale(1.2);
      background: #1db95433;
    }
    button.active svg {
      fill: #1db954;
    }
    button svg {
      width: 24px;
      height: 24px;
      fill: #fff;
    }
    #playlist {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: 300px;
      overflow-y: auto;
      width: 100%;
      max-width: 600px;
    }
    .track {
      background: #333;
      padding: 12px 15px;
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.3s ease, background 0.3s ease;
    }
    .track:hover {
      transform: translateY(-3px);
      background: #444;
    }
    .track.active {
      background: #1db954;
      color: #000;
    }
    .track-title {
      font-weight: 500;
      font-size: 1rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
  </style>
</head>
<body>

<h1>Renz Music Player</h1>
<input type="text" id="searchBox" placeholder="Cari lagu..." />

<div id="player">
  <audio id="audio" controls></audio>
  <div class="controls">
    <button id="prev">
      <svg viewBox="0 0 24 24"><path d="M6 4v16h2V4zm3.5 8 9.5 6V6z"/></svg>
    </button>
    <button id="play">
      <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
    </button>
    <button id="next">
      <svg viewBox="0 0 24 24"><path d="M16 4v16h-2V4zm-3.5 8L3 18V6z"/></svg>
    </button>
    <button id="shuffle">
      <svg viewBox="0 0 24 24"><path d="M17 3h4v4h-2V5h-2V3zM3 17h2v2h2v2H3v-4zm14-1.59-4.3-4.3 1.41-1.41 4.3 4.3V9h2v7h-7v-2h3.59zM3 3h4v2H5v2H3V3zm12.3 7.3L11 14.59V17H9v-4h4v2h-1.59l3.3-3.29z"/></svg>
    </button>
    <button id="repeat">
      <svg viewBox="0 0 24 24"><path d="M17 17H7v-3l-4 4 4 4v-3h10c1.1 0 2-.9 2-2v-5h-2v5zm0-10H7v3L3 6l4-4v3h10c1.1 0 2 .9 2 2v5h-2V7z"/></svg>
    </button>
  </div>
</div>

<div id="playlist"></div>

<script>
  const audio = document.getElementById('audio');
  const playBtn = document.getElementById('play');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');
  const shuffleBtn = document.getElementById('shuffle');
  const repeatBtn = document.getElementById('repeat');
  const searchBox = document.getElementById('searchBox');
  const playlistDiv = document.getElementById('playlist');

  let tracks = [];
  let current = 0;
  let isShuffle = false;
  let isRepeat = false;

  function fetchTracks(query) {
    fetch(`https://theaudiodb.com/api/v1/json/3/searchtrack.php?s=${encodeURIComponent(query)}`)
      .then(res => res.json())
      .then(data => {
        if (!data.track) {
          playlistDiv.innerHTML = '<div style="padding:15px;color:#aaa">Tidak ada hasil.</div>';
          return;
        }
        tracks = data.track.map(t => ({
          title: t.strTrack || 'Unknown',
          artist: t.strArtist || '-',
          file: t.strMusicVid || '', 
          cover: t.strTrackThumb || t.strAlbumThumb || ''
        }));
        current = 0;
        renderPlaylist();
        loadTrack();
      });
  }

  function renderPlaylist() {
    playlistDiv.innerHTML = '';
    tracks.forEach((track, index) => {
      const div = document.createElement('div');
      div.className = 'track' + (index === current ? ' active' : '');
      div.innerHTML = `<div class="track-title">${track.title} - ${track.artist}</div>`;
      div.onclick = () => {
        current = index;
        loadTrack();
        playTrack();
      };
      playlistDiv.appendChild(div);
    });
  }

  function loadTrack() {
    if (tracks.length === 0) return;
    audio.src = tracks[current].file;
    updateActiveTrack();
  }

  function playTrack() {
    if (!audio.src) return;
    audio.play();
    playBtn.innerHTML = `<svg viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>`;
  }

  function pauseTrack() {
    audio.pause();
    playBtn.innerHTML = `<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>`;
  }

  function updateActiveTrack() {
    const trackElements = document.querySelectorAll('.track');
    trackElements.forEach((el, index) => {
      el.classList.toggle('active', index === current);
    });
  }

  playBtn.addEventListener('click', () => {
    if (audio.paused) playTrack();
    else pauseTrack();
  });

  prevBtn.addEventListener('click', () => {
    current = (current - 1 + tracks.length) % tracks.length;
    loadTrack();
    playTrack();
  });

  nextBtn.addEventListener('click', () => {
    current = (current + 1) % tracks.length;
    loadTrack();
    playTrack();
  });

  shuffleBtn.addEventListener('click', () => {
    isShuffle = !isShuffle;
    shuffleBtn.classList.toggle('active', isShuffle);
  });

  repeatBtn.addEventListener('click', () => {
    isRepeat = !isRepeat;
    repeatBtn.classList.toggle('active', isRepeat);
  });

  audio.addEventListener('ended', () => {
    if (isRepeat) {
      loadTrack();
      playTrack();
    } else if (isShuffle) {
      current = Math.floor(Math.random() * tracks.length);
      loadTrack();
      playTrack();
    } else {
      nextBtn.click();
    }
  });

  searchBox.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') fetchTracks(e.target.value);
  });
</script>

</body>
</html>
